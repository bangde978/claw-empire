# Claw-Empire v1.1.5 Release Notes

- Release date: 2026-02-22
- Scope: Task/project creation UX overhaul, project-path safety tooling, and CLI spawn stability hardening.

## Highlights

- **Project-Name Input + Click Dropdown**
  - In `+ New Task`, project selection now starts with a text input (`Project Name`) and click-to-open suggestion list.
  - Keyboard navigation (`ArrowUp/ArrowDown/Enter/Escape`) is supported for fast selection.

- **Inline New-Project Branching**
  - When no project matches typed input, the modal now shows `Create as a new project?` with a right-aligned high-contrast `Yes` action.
  - The previous `No matching project` dead-end flow was replaced with a direct branch.

- **Create Project + Task Together**
  - In new-project mode, submitting the form now creates the project first and then the task in one flow.
  - `Description` is required in this mode and is persisted as the project `core_goal`.
  - New project path entry (`project_path`) is displayed only when new-project mode is enabled and is validated before submission.

- **Desktop/Mobile Layout + Overflow Fix**
  - Desktop: create modal expands to a 1:1 two-column layout when new-project mode is active, with animated right-side reveal for `Priority` and `Assignee`.
  - Mobile: retains vertical scroll behavior to prevent clipping/overflow issues on long forms.
  - Clicking outside the create modal no longer closes it, preventing accidental data loss during path editing.

- **Draft Autosave and Recovery UX**
  - Added local draft persistence (`climpire.taskCreateDrafts`) with autosave on explicit close (`X`, `Cancel`).
  - Added `[Temp(n)]` submodal for inspecting, loading, and deleting temporary drafts.
  - Replaced legacy confirmation dialogs with a styled recovery submodal.
  - Recovery prompt now shows only the latest 3 drafts and allows selecting one before loading.

- **Project Path Finder Suite (Task + Project Manager)**
  - Added three path helper actions: `In-App Folder Browser`, `Auto Path Finder`, and OS-native `Manual Path Finder`.
  - The same path helper controls are now available in Project Manager under `Project Path`.
  - In Project Manager, path helper controls are visible only while creating/editing a project.

- **Project Path Guardrails (API + DB Flow)**
  - Added path utility APIs:
    - `GET /api/projects/path-check`
    - `GET /api/projects/path-suggestions`
    - `GET /api/projects/path-browse`
    - `POST /api/projects/path-native-picker`
  - Added path normalization (`~`, `~/...`, `/Projects/...`, `/projects/...`) for consistent matching.
  - `POST /api/projects` and `PATCH /api/projects/:id` now support `create_path_if_missing` with explicit confirmation flow.
  - `POST /api/projects`, `PATCH /api/projects/:id`, and `GET /api/projects/path-check` now reject out-of-scope paths with `project_path_outside_allowed_roots` when path-root restrictions are configured.
  - Duplicate project paths are now blocked at create/update time with explicit `project_path_conflict` responses.

- **Path Helper Compatibility + Error UX Hardening**
  - Task creation and Project Manager now handle missing helper APIs (`404`) gracefully and fall back to manual path entry.
  - Legacy `alert/confirm` prompts in task creation flow were replaced with in-modal feedback/submodals for a consistent UX.
  - Headless or unavailable OS-native folder-picker environments now show explicit guidance and disable unavailable actions.

- **Task API Project Mapping Hardening**
  - Frontend now passes `project_id` and `project_path` during task creation.
  - Backend now resolves a project by `project_path` when `project_id` is absent, improving project linkage reliability.

- **CLI Spawn ENOENT Resilience**
  - Runtime now appends platform-specific fallback bin directories to `PATH` before provider spawn.
  - This reduces `spawn codex ENOENT` / `spawn claude ENOENT` failures in mixed shell launch environments.

## Changed Files (Major)

### Frontend
- `src/components/TaskBoard.tsx`
- `src/App.tsx`
- `src/components/ProjectManagerModal.tsx`
- `src/api.ts`

### Backend
- `server/modules/routes/core.ts`
- `server/modules/workflow/agents.ts`
- `server/modules/workflow/core.ts`

### Docs
- `README.md`
- `README_ko.md`
- `README_jp.md`
- `README_zh.md`
- `docs/releases/README.md`
- `docs/releases/v1.1.5.md`

### QA / Tooling
- `scripts/qa/project-path-api-smoke.mjs`
- `package.json`

## Verification

- `pnpm run test:web`
  - web tests passed
- `pnpm run test:api`
  - api tests passed
- `QA_API_AUTH_TOKEN=<token> pnpm run test:qa:project-path`
  - path helper / project-path conflict smoke passed
- `pnpm run build`
  - `tsc -b` passed
  - `vite build` passed

## Notes

- Draft restore prompt now avoids duplicate confirmation and is fully rendered as in-app submodals.
- Project-path safety flow now behaves consistently across task creation and project management.
- Existing release documents (`v1.1.4` and below) remain unchanged for historical traceability.
